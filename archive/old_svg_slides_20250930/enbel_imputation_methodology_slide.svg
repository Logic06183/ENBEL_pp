<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080" style="background: #ffffff;">
  <defs>
    <!-- LaTeX academic color scheme -->
    <linearGradient id="latexBlueGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#00549F;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#003366;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="latexTealGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#008080;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#006666;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="beamerHeader" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#00549F;stop-opacity:1" />
      <stop offset="50%" style="stop-color:#003f7f;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#002856;stop-opacity:1" />
    </linearGradient>
    
    <!-- Process step gradients -->
    <linearGradient id="demographicGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1E90FF;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1565C0;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="spatialGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#228B22;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2E7D32;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="weightingGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FF6B35;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E64A19;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="imputationGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8A2BE2;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#6A1B9A;stop-opacity:1" />
    </linearGradient>
    
    <!-- LaTeX-style subtle pattern -->
    <pattern id="latexPattern" patternUnits="userSpaceOnUse" width="60" height="60">
      <rect width="60" height="60" fill="#fafafa"/>
      <path d="M 60 0 L 0 0 0 60" fill="none" stroke="#f0f0f0" stroke-width="0.3"/>
    </pattern>
    
    <!-- Academic block shadow -->
    <filter id="academicShadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="3" dy="6" stdDeviation="4" flood-color="#404040" flood-opacity="0.2"/>
    </filter>
    
    <filter id="lightShadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="3" stdDeviation="2" flood-color="#404040" flood-opacity="0.15"/>
    </filter>
    
    <!-- Arrow markers -->
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#00549F" />
    </marker>
    
    <!-- LaTeX typography styles -->
    <style>
      .latex-serif { font-family: "Times New Roman", "Computer Modern", serif; }
      .latex-sans { font-family: "Helvetica", "Computer Modern Sans", sans-serif; }
      .latex-mono { font-family: "Courier New", "Computer Modern Typewriter", monospace; }
      .math-notation { font-family: "Times New Roman", "Computer Modern", serif; font-style: italic; }
    </style>
  </defs>
  
  <!-- LaTeX-style background -->
  <rect width="1920" height="1080" fill="url(#latexPattern)"/>
  
  <!-- LaTeX Beamer header bar -->
  <rect x="0" y="0" width="1920" height="12" fill="url(#beamerHeader)"/>
  
  <!-- LaTeX Beamer frame title -->
  <g id="frame-title">
    <rect x="60" y="30" width="1800" height="50" rx="4" ry="4" fill="url(#latexBlueGradient)"/>
    <text x="80" y="60" class="latex-serif" font-size="32" font-weight="bold" fill="#ffffff">
      Multi-dimensional Socioeconomic Imputation Framework
    </text>
  </g>
  
  <!-- Main flow diagram container -->
  <g id="flow-diagram" transform="translate(960, 350)">
    
    <!-- Step 1: Input Data -->
    <g transform="translate(-750, 0)">
      <rect x="-120" y="-60" width="240" height="120" rx="8" ry="8" fill="#ffffff" stroke="#00549F" stroke-width="2" filter="url(#lightShadow)"/>
      <text x="0" y="-25" text-anchor="middle" class="latex-sans" font-size="16" font-weight="bold" fill="#00549F">Clinical Cohort</text>
      <text x="0" y="0" text-anchor="middle" class="latex-mono" font-size="14" fill="#404040">n = 4,957</text>
      <text x="0" y="20" text-anchor="middle" class="latex-serif" font-size="13" fill="#606060">Missing socioeconomic</text>
      <text x="0" y="38" text-anchor="middle" class="latex-serif" font-size="13" fill="#606060">variables</text>
    </g>
    
    <g transform="translate(-750, 200)">
      <rect x="-120" y="-60" width="240" height="120" rx="8" ry="8" fill="#ffffff" stroke="#008080" stroke-width="2" filter="url(#lightShadow)"/>
      <text x="0" y="-25" text-anchor="middle" class="latex-sans" font-size="16" font-weight="bold" fill="#008080">G-SORO Cohort</text>
      <text x="0" y="0" text-anchor="middle" class="latex-mono" font-size="14" fill="#404040">n = 12,458</text>
      <text x="0" y="20" text-anchor="middle" class="latex-serif" font-size="13" fill="#606060">Complete socioeconomic</text>
      <text x="0" y="38" text-anchor="middle" class="latex-serif" font-size="13" fill="#606060">profiles available</text>
    </g>
    
    <!-- Arrows from input to demographic matching -->
    <line x1="-630" y1="0" x2="-480" y2="0" stroke="#00549F" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="-630" y1="200" x2="-480" y2="100" stroke="#008080" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- Step 2: Demographic Matching -->
    <g transform="translate(-360, 50)" filter="url(#academicShadow)">
      <rect x="-100" y="-80" width="200" height="160" rx="6" ry="6" fill="#ffffff" stroke="#e0e0e0" stroke-width="1"/>
      <rect x="-100" y="-80" width="200" height="35" rx="6" ry="6" fill="url(#demographicGradient)"/>
      <rect x="-100" y="-45" width="200" height="8" fill="url(#demographicGradient)"/>
      <text x="0" y="-55" text-anchor="middle" class="latex-sans" font-size="15" font-weight="bold" fill="#ffffff">Demographic Matching</text>
      
      <g transform="translate(0, -10)">
        <text x="0" y="15" text-anchor="middle" class="latex-serif" font-size="13" font-weight="bold" fill="#1565C0">Sex Mapping:</text>
        <text x="0" y="32" text-anchor="middle" class="latex-mono" font-size="11" fill="#404040">'1.0' → Male</text>
        <text x="0" y="46" text-anchor="middle" class="latex-mono" font-size="11" fill="#404040">'2.0' → Female</text>
        
        <text x="0" y="68" text-anchor="middle" class="latex-serif" font-size="13" font-weight="bold" fill="#1565C0">Race Mapping:</text>
        <text x="-45" y="85" text-anchor="middle" class="latex-mono" font-size="11" fill="#404040">1.0→Black</text>
        <text x="45" y="85" text-anchor="middle" class="latex-mono" font-size="11" fill="#404040">2.0→White</text>
        <text x="-45" y="99" text-anchor="middle" class="latex-mono" font-size="11" fill="#404040">3.0→Coloured</text>
        <text x="45" y="99" text-anchor="middle" class="latex-mono" font-size="11" fill="#404040">4.0→Asian</text>
      </g>
    </g>
    
    <!-- Step 3: Spatial Proximity -->
    <g transform="translate(-360, 250)" filter="url(#academicShadow)">
      <rect x="-100" y="-60" width="200" height="120" rx="6" ry="6" fill="#ffffff" stroke="#e0e0e0" stroke-width="1"/>
      <rect x="-100" y="-60" width="200" height="35" rx="6" ry="6" fill="url(#spatialGradient)"/>
      <rect x="-100" y="-25" width="200" height="8" fill="url(#spatialGradient)"/>
      <text x="0" y="-35" text-anchor="middle" class="latex-sans" font-size="15" font-weight="bold" fill="#ffffff">Spatial Proximity</text>
      
      <g transform="translate(0, 0)">
        <text x="0" y="5" text-anchor="middle" class="latex-serif" font-size="13" font-weight="bold" fill="#2E7D32">Haversine Distance</text>
        <text x="0" y="22" text-anchor="middle" class="latex-mono" font-size="11" fill="#404040">Max: 25km threshold</text>
        <text x="0" y="38" text-anchor="middle" class="latex-serif" font-size="11" fill="#606060">Accounts for clinic</text>
        <text x="0" y="52" text-anchor="middle" class="latex-serif" font-size="11" fill="#606060">coordinates</text>
      </g>
    </g>
    
    <!-- Arrows to weighting scheme -->
    <line x1="-260" y1="50" x2="-100" y2="100" stroke="#1565C0" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="-260" y1="250" x2="-100" y2="150" stroke="#2E7D32" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- Step 4: Weighting Scheme (Central) -->
    <g transform="translate(0, 125)" filter="url(#academicShadow)">
      <rect x="-120" y="-75" width="240" height="150" rx="6" ry="6" fill="#ffffff" stroke="#e0e0e0" stroke-width="1"/>
      <rect x="-120" y="-75" width="240" height="35" rx="6" ry="6" fill="url(#weightingGradient)"/>
      <rect x="-120" y="-40" width="240" height="8" fill="url(#weightingGradient)"/>
      <text x="0" y="-50" text-anchor="middle" class="latex-sans" font-size="15" font-weight="bold" fill="#ffffff">Combined Weighting</text>
      
      <!-- Visual weight representation -->
      <g transform="translate(0, -5)">
        <!-- Demographic weight -->
        <rect x="-80" y="5" width="128" height="30" rx="4" ry="4" fill="#1565C0" opacity="0.8"/>
        <text x="-16" y="25" text-anchor="middle" class="latex-sans" font-size="14" font-weight="bold" fill="#ffffff">80%</text>
        
        <!-- Spatial weight -->
        <rect x="48" y="5" width="32" height="30" rx="4" ry="4" fill="#2E7D32" opacity="0.8"/>
        <text x="64" y="25" text-anchor="middle" class="latex-sans" font-size="14" font-weight="bold" fill="#ffffff">20%</text>
        
        <text x="0" y="55" text-anchor="middle" class="math-notation" font-size="13" fill="#404040">Score = 0.8 × Demo + 0.2 × Spatial</text>
      </g>
    </g>
    
    <!-- Arrow to KNN -->
    <line x1="120" y1="125" x2="260" y2="125" stroke="#E64A19" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- Step 5: K-Nearest Neighbors -->
    <g transform="translate(380, 125)" filter="url(#academicShadow)">
      <rect x="-110" y="-75" width="220" height="150" rx="6" ry="6" fill="#ffffff" stroke="#e0e0e0" stroke-width="1"/>
      <rect x="-110" y="-75" width="220" height="35" rx="6" ry="6" fill="url(#imputationGradient)"/>
      <rect x="-110" y="-40" width="220" height="8" fill="url(#imputationGradient)"/>
      <text x="0" y="-50" text-anchor="middle" class="latex-sans" font-size="15" font-weight="bold" fill="#ffffff">K-NN Imputation</text>
      
      <g transform="translate(0, -5)">
        <text x="0" y="5" text-anchor="middle" class="latex-serif" font-size="13" font-weight="bold" fill="#6A1B9A">k = 15 neighbors</text>
        <text x="0" y="22" text-anchor="middle" class="latex-serif" font-size="11" fill="#404040">Threshold: score &gt; 0.2</text>
        <text x="0" y="38" text-anchor="middle" class="latex-serif" font-size="11" fill="#404040">Min matches: 3</text>
        <text x="0" y="54" text-anchor="middle" class="latex-serif" font-size="11" fill="#606060">Weighted averaging</text>
      </g>
    </g>
    
    <!-- Arrow to output -->
    <line x1="490" y1="125" x2="620" y2="100" stroke="#6A1B9A" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- Step 6: Imputed Variables (Output) -->
    <g transform="translate(750, 100)" filter="url(#academicShadow)">
      <rect x="-120" y="-120" width="240" height="240" rx="6" ry="6" fill="#ffffff" stroke="#e0e0e0" stroke-width="1"/>
      <rect x="-120" y="-120" width="240" height="35" rx="6" ry="6" fill="url(#latexTealGradient)"/>
      <rect x="-120" y="-85" width="240" height="8" fill="url(#latexTealGradient)"/>
      <text x="0" y="-95" text-anchor="middle" class="latex-sans" font-size="15" font-weight="bold" fill="#ffffff">Imputed Variables</text>
      
      <g transform="translate(-100, -50)">
        <text x="0" y="0" class="latex-serif" font-size="12" font-weight="bold" fill="#006666">Socioeconomic:</text>
        <text x="5" y="18" class="latex-mono" font-size="11" fill="#404040">• Education</text>
        <text x="5" y="34" class="latex-mono" font-size="11" fill="#404040">• Employment status</text>
        
        <text x="0" y="56" class="latex-serif" font-size="12" font-weight="bold" fill="#006666">Vulnerability indices:</text>
        <text x="5" y="74" class="latex-mono" font-size="11" fill="#404040">• Housing vulnerability</text>
        <text x="5" y="90" class="latex-mono" font-size="11" fill="#404040">• Economic vulnerability</text>
        <text x="5" y="106" class="latex-mono" font-size="11" fill="#404040">• Heat vulnerability index</text>
        
        <text x="0" y="128" class="latex-serif" font-size="12" font-weight="bold" fill="#006666">Quality metrics:</text>
        <text x="5" y="146" class="latex-mono" font-size="11" fill="#404040">• Confidence scores</text>
        <text x="5" y="162" class="latex-mono" font-size="11" fill="#404040">• Similarity weights</text>
      </g>
    </g>
  </g>
  
  <!-- Key features box (bottom left) -->
  <g transform="translate(80, 750)" filter="url(#lightShadow)">
    <rect x="0" y="0" width="400" height="280" rx="6" ry="6" fill="#ffffff" stroke="#00549F" stroke-width="1" opacity="0.95"/>
    <text x="20" y="30" class="latex-serif" font-size="16" font-weight="bold" fill="#00549F">Key Technical Features</text>
    
    <g transform="translate(20, 50)">
      <text x="0" y="20" class="latex-serif" font-size="13" fill="#404040">• Multi-dimensional matching algorithm</text>
      <text x="0" y="40" class="latex-serif" font-size="13" fill="#404040">• Handles string-encoded demographic codes</text>
      <text x="0" y="60" class="latex-serif" font-size="13" fill="#404040">• Relaxed spatial constraints for clinic-based data</text>
      <text x="0" y="80" class="latex-serif" font-size="13" fill="#404040">• Batch processing for computational efficiency</text>
      <text x="0" y="100" class="latex-serif" font-size="13" fill="#404040">• Categorical mode / continuous mean imputation</text>
      <text x="0" y="120" class="latex-serif" font-size="13" fill="#404040">• Penalty-based confidence scoring</text>
      <text x="0" y="140" class="latex-serif" font-size="13" fill="#404040">• Validates matches before imputation</text>
      <text x="0" y="160" class="latex-serif" font-size="13" fill="#404040">• Preserves data provenance metadata</text>
    </g>
    
    <rect x="0" y="240" width="400" height="40" rx="4" ry="4" fill="#f0f8ff"/>
    <text x="200" y="265" text-anchor="middle" class="latex-mono" font-size="12" fill="#00549F">fixed_multidimensional_imputation.py v2.0</text>
  </g>
  
  <!-- Performance metrics box (bottom right) -->
  <g transform="translate(1440, 750)" filter="url(#lightShadow)">
    <rect x="0" y="0" width="400" height="280" rx="6" ry="6" fill="#ffffff" stroke="#008080" stroke-width="1" opacity="0.95"/>
    <text x="20" y="30" class="latex-serif" font-size="16" font-weight="bold" fill="#008080">Implementation Performance</text>
    
    <g transform="translate(20, 50)">
      <text x="0" y="20" class="latex-serif" font-size="13" fill="#404040">Coverage achieved: ~42% average</text>
      <text x="0" y="40" class="latex-serif" font-size="13" fill="#404040">High confidence matches: &gt;50% threshold</text>
      <text x="0" y="60" class="latex-serif" font-size="13" fill="#404040">Processing: 50-participant batches</text>
      <text x="0" y="80" class="latex-serif" font-size="13" fill="#404040">Distance decay: exp(-d/8) function</text>
      <text x="0" y="100" class="latex-serif" font-size="13" fill="#404040">Sex mismatch penalty: 70%</text>
      <text x="0" y="120" class="latex-serif" font-size="13" fill="#404040">Race mismatch penalty: 60%</text>
      <text x="0" y="140" class="latex-serif" font-size="13" fill="#404040">Minimum valid neighbors: 3</text>
      <text x="0" y="160" class="latex-serif" font-size="13" fill="#404040">Output: CSV with confidence metrics</text>
    </g>
    
    <rect x="0" y="240" width="400" height="40" rx="4" ry="4" fill="#f0fff8"/>
    <text x="200" y="265" text-anchor="middle" class="latex-mono" font-size="12" fill="#008080">ENBEL Project - Climate Health Nexus</text>
  </g>
  
  <!-- Mathematical notation (center bottom) -->
  <g transform="translate(960, 850)">
    <rect x="-300" y="-40" width="600" height="80" rx="6" ry="6" fill="#fafafa" stroke="#c0c0c0" stroke-width="1"/>
    <text x="0" y="-10" text-anchor="middle" class="math-notation" font-size="14" fill="#404040">
      Combined Score = 0.8 × Σ(demographic_match) + 0.2 × exp(-distance/8)
    </text>
    <text x="0" y="15" text-anchor="middle" class="math-notation" font-size="14" fill="#404040">
      Confidence = similarity_score × Π(penalty_factors) × neighborhood_consistency
    </text>
  </g>
  
  <!-- Footer -->
  <g transform="translate(960, 1050)">
    <text x="0" y="0" text-anchor="middle" class="latex-serif" font-size="11" fill="#808080">
      ENBEL Multi-dimensional Imputation Framework | Climate-Health Data Integration | 2024
    </text>
  </g>
</svg>